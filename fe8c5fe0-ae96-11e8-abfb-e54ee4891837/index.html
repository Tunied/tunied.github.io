<!DOCTYPE html>




<html class="theme-next gemini" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="HaFr6IFRWpWkG_Eyt4dUUQlgTyTE85bMpbJKQQgp0Rw" />














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Lua," />










<meta name="description" content="å¦‚ä½•ç»„ç»‡ä»£ç Luaå’ŒJSä¸€æ ·éƒ½æ˜¯è§£é‡Šå‹è¯­è¨€,æ²¡æœ‰å…¥å£çš„æ¦‚å¿µ. ä½†æ˜¯è¦å®ç°æ–‡ç« 1ç»“å°¾æ—¶å€™æ‰€è¯´çš„Codingç¯å¢ƒ  å†™ä¸ªå…¥å£æ–‡ä»¶ main.lua ç„¶åæ¯ä¸ªç±»ä¸€ä¸ªæ–‡ä»¶ ä»å…¥å£æ–‡ä»¶çš„æŸä¸ªå‡½æ•°å¼€å§‹æ‰§è¡Œ ç„¶åæŠŠæ•´ä¸ªç¨‹åºRunèµ·æ¥  æˆ‘èƒ½æƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆæ˜¯  é¦–å…ˆé€šè¿‡æŸç§æ–¹æ³•å¯ä»¥ç”¨Luaæ¨¡æ‹Ÿå‡ºç±»çš„æ¦‚å¿µ  å°†æ¯ä¸€ä¸ªç±»éƒ½å•ç‹¬å»ºç«‹ä¸€ä¸ª*.">
<meta name="keywords" content="Lua">
<meta property="og:type" content="article">
<meta property="og:title" content="Luaä»å…¥é—¨åˆ°å…¥äº†é—¨(2) åŸºç¡€éš¾ç‚¹æ¦‚è¿°">
<meta property="og:url" content="http://www.oldking.wang/fe8c5fe0-ae96-11e8-abfb-e54ee4891837/index.html">
<meta property="og:site_name" content="éš”å£è€ç‹">
<meta property="og:description" content="å¦‚ä½•ç»„ç»‡ä»£ç Luaå’ŒJSä¸€æ ·éƒ½æ˜¯è§£é‡Šå‹è¯­è¨€,æ²¡æœ‰å…¥å£çš„æ¦‚å¿µ. ä½†æ˜¯è¦å®ç°æ–‡ç« 1ç»“å°¾æ—¶å€™æ‰€è¯´çš„Codingç¯å¢ƒ  å†™ä¸ªå…¥å£æ–‡ä»¶ main.lua ç„¶åæ¯ä¸ªç±»ä¸€ä¸ªæ–‡ä»¶ ä»å…¥å£æ–‡ä»¶çš„æŸä¸ªå‡½æ•°å¼€å§‹æ‰§è¡Œ ç„¶åæŠŠæ•´ä¸ªç¨‹åºRunèµ·æ¥  æˆ‘èƒ½æƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆæ˜¯  é¦–å…ˆé€šè¿‡æŸç§æ–¹æ³•å¯ä»¥ç”¨Luaæ¨¡æ‹Ÿå‡ºç±»çš„æ¦‚å¿µ  å°†æ¯ä¸€ä¸ªç±»éƒ½å•ç‹¬å»ºç«‹ä¸€ä¸ª*.luaæ–‡ä»¶  å»ºç«‹ä¸€ä¸ªLoad.luaå’ŒMain.luaæ–‡ä»¶(Main.luaä¹Ÿ">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-09-03T16:57:55.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Luaä»å…¥é—¨åˆ°å…¥äº†é—¨(2) åŸºç¡€éš¾ç‚¹æ¦‚è¿°">
<meta name="twitter:description" content="å¦‚ä½•ç»„ç»‡ä»£ç Luaå’ŒJSä¸€æ ·éƒ½æ˜¯è§£é‡Šå‹è¯­è¨€,æ²¡æœ‰å…¥å£çš„æ¦‚å¿µ. ä½†æ˜¯è¦å®ç°æ–‡ç« 1ç»“å°¾æ—¶å€™æ‰€è¯´çš„Codingç¯å¢ƒ  å†™ä¸ªå…¥å£æ–‡ä»¶ main.lua ç„¶åæ¯ä¸ªç±»ä¸€ä¸ªæ–‡ä»¶ ä»å…¥å£æ–‡ä»¶çš„æŸä¸ªå‡½æ•°å¼€å§‹æ‰§è¡Œ ç„¶åæŠŠæ•´ä¸ªç¨‹åºRunèµ·æ¥  æˆ‘èƒ½æƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆæ˜¯  é¦–å…ˆé€šè¿‡æŸç§æ–¹æ³•å¯ä»¥ç”¨Luaæ¨¡æ‹Ÿå‡ºç±»çš„æ¦‚å¿µ  å°†æ¯ä¸€ä¸ªç±»éƒ½å•ç‹¬å»ºç«‹ä¸€ä¸ª*.luaæ–‡ä»¶  å»ºç«‹ä¸€ä¸ªLoad.luaå’ŒMain.luaæ–‡ä»¶(Main.luaä¹Ÿ">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.oldking.wang/fe8c5fe0-ae96-11e8-abfb-e54ee4891837/"/>





  <title>Luaä»å…¥é—¨åˆ°å…¥äº†é—¨(2) åŸºç¡€éš¾ç‚¹æ¦‚è¿° | éš”å£è€ç‹</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-111727312-1', 'auto');
  ga('send', 'pageview');
</script>





</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">éš”å£è€ç‹</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">ç‹¬ç«‹æ¸¸æˆå¼€å‘è€…</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-unity">
          <a href="/categories/Unity" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-diamond"></i> <br />
            
            Unity
          </a>
        </li>
      
        
        <li class="menu-item menu-item-ç¼–ç¨‹">
          <a href="/categories/ç¼–ç¨‹" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-graduation-cap"></i> <br />
            
            ç¼–ç¨‹
          </a>
        </li>
      
        
        <li class="menu-item menu-item-ä½œå¼Š">
          <a href="/categories/CheatSheet" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-bolt"></i> <br />
            
            ä½œå¼Š
          </a>
        </li>
      
        
        <li class="menu-item menu-item-å…¶ä»–">
          <a href="/categories/å…¶ä»–" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-beer"></i> <br />
            
            å…¶ä»–
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.oldking.wang/fe8c5fe0-ae96-11e8-abfb-e54ee4891837/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="éš”å£è€ç‹">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="éš”å£è€ç‹">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Luaä»å…¥é—¨åˆ°å…¥äº†é—¨(2) åŸºç¡€éš¾ç‚¹æ¦‚è¿°</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-09-02T18:00:02+08:00">
                2018-09-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ç¼–ç¨‹/" itemprop="url" rel="index">
                    <span itemprop="name">ç¼–ç¨‹</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>æµè§ˆ
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>æ¬¡
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="å¦‚ä½•ç»„ç»‡ä»£ç "><a href="#å¦‚ä½•ç»„ç»‡ä»£ç " class="headerlink" title="å¦‚ä½•ç»„ç»‡ä»£ç "></a>å¦‚ä½•ç»„ç»‡ä»£ç </h2><p>Luaå’ŒJSä¸€æ ·éƒ½æ˜¯<code>è§£é‡Šå‹è¯­è¨€</code>,æ²¡æœ‰å…¥å£çš„æ¦‚å¿µ. ä½†æ˜¯è¦å®ç°æ–‡ç« 1ç»“å°¾æ—¶å€™æ‰€è¯´çš„Codingç¯å¢ƒ</p>
<blockquote>
<p>å†™ä¸ªå…¥å£æ–‡ä»¶ <code>main.lua</code> ç„¶åæ¯ä¸ªç±»ä¸€ä¸ªæ–‡ä»¶ ä»å…¥å£æ–‡ä»¶çš„æŸä¸ªå‡½æ•°å¼€å§‹æ‰§è¡Œ ç„¶åæŠŠæ•´ä¸ªç¨‹åºRunèµ·æ¥</p>
</blockquote>
<p>æˆ‘èƒ½æƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆæ˜¯</p>
<ol>
<li><p>é¦–å…ˆé€šè¿‡æŸç§æ–¹æ³•å¯ä»¥ç”¨Luaæ¨¡æ‹Ÿå‡ºç±»çš„æ¦‚å¿µ</p>
</li>
<li><p>å°†æ¯ä¸€ä¸ªç±»éƒ½å•ç‹¬å»ºç«‹ä¸€ä¸ª<code>*.lua</code>æ–‡ä»¶</p>
</li>
<li><p>å»ºç«‹ä¸€ä¸ª<code>Load.lua</code>å’Œ<code>Main.lua</code>æ–‡ä»¶(Main.luaä¹Ÿæ˜¯æ¨¡æ‹Ÿå‡ºæ¥çš„ç±»),<code>Main</code>ç±»é‡Œé¢æœ‰ä¸€ä¸ª<code>Start()</code>æ–¹æ³•</p>
</li>
<li><p>åœ¨<code>Load.lua</code>ä¸­é€šè¿‡<code>require</code>å‡½æ•°å°†å…¶ä½™æ‰€æœ‰çš„æ–‡ä»¶éƒ½requireè¿›æ¥,ç„¶ånewä¸€ä¸ªMainçš„å¯¹è±¡æ‰§è¡Œ<code>Start()</code>æ–¹æ³• å¼€å§‹æ•´ä¸ªç¨‹åº</p>
</li>
</ol>
<p>ä¼ªç å¦‚ä¸‹:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">require</span>(<span class="string">"ClassA"</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">"ClassB"</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">"ClassC"</span>)</span><br><span class="line">...</span><br><span class="line"><span class="built_in">require</span>(<span class="string">"ClassY"</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">"ClassZ"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--éƒ½requireå®Œäº†ä»¥åæ‰§è¡Œ:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> entry = Main.new();</span><br><span class="line">entry.Start();</span><br></pre></td></tr></table></figure>
<h3 id="å®é™…é¡¹ç›®"><a href="#å®é™…é¡¹ç›®" class="headerlink" title="å®é™…é¡¹ç›®"></a>å®é™…é¡¹ç›®</h3><p>å› ä¸ºæ²¡å’Œå…¶ä»–äººäº¤æµè¿‡ ä¹Ÿä¸çŸ¥é“ è¿™æ˜¯ä¸æ˜¯ä¸ªæ ‡å‡†æµç¨‹ ,ä¸è¿‡æˆ‘è‡ªå·±çš„é¡¹ç›®æ˜¯å‡†å¤‡è¿™ä¹ˆå¼„çš„. </p>
<p>ä¼šæœ‰ä¸€äº›æ”¹åŠ¨ å› ä¸ºæœ‰éƒ¨åˆ†ä»£ç åº”è¯¥ä¼šç›´æ¥å’Œ<code>GameObject</code>åšåŒå‘ç»‘å®š,æ‰€ä»¥ä¸ä¸€å®šå…¥å£æ–‡ä»¶éœ€è¦å°†æ‰€æœ‰æ–‡ä»¶éƒ½<code>require</code>è¿›æ¥,å¹¶ä¸”å…¥å£æ–‡ä»¶ä¹Ÿä¸ä¸€å®šä¼šåªæœ‰ä¸€ä¸ª.</p>
<p>å¦å¤–ä¸€ä¸ªå°±æ˜¯<code>Load.lua</code>è¿™ä¸ªæ–‡ä»¶åˆ°æ—¶å€™åº”è¯¥ä¼šæ ¹æ®æŸç§é…ç½®ç”¨ç¨‹åºç”Ÿæˆ. </p>
<p>æ¯”å¦‚<code>Lua/InitLoad/*.lua</code>ä¸‹é¢çš„æ–‡ä»¶éƒ½åˆå§‹æ—¶å€™åŠ è½½,ç„¶å<code>Lua/Manual/*.lua</code>ä¸‹é¢çš„æ–‡ä»¶éƒ½æ‰‹åŠ¨åŠ è½½.  </p>
<p>æˆ–è€…ç›´æ¥ç”¨å‰ç¼€åšåŒºåˆ† <code>Init_$ClassName.lua</code>,<code>Manual_$ClassName.lua</code></p>
<p>ä½†æ˜¯å¤§ä½“ä¸Šæ¥è¯´,ç»“æ„ä¼šæŒ‰ç…§ä¸Šé¢æ‰€è¯´çš„é‚£æ ·.</p>
<h3 id="require-ä¸­-localçš„ä½œç”¨åŸŸ"><a href="#require-ä¸­-localçš„ä½œç”¨åŸŸ" class="headerlink" title="require ä¸­ localçš„ä½œç”¨åŸŸ"></a>require ä¸­ localçš„ä½œç”¨åŸŸ</h3><p>è¿™æ˜¯æˆ‘å½“æ—¶æœ‰äº›æ²¡ææ‡‚çš„åœ°æ–¹,å°±æ˜¯local å˜é‡ä½œç”¨åŸŸçš„é—®é¢˜. ä¸€ä¸ªlocalå˜é‡ æ”¾åœ¨ä¸€ä¸ªforå¾ªç¯é‡Œé¢,æˆ–è€…æ”¾åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ éƒ½å¾ˆå¥½ç†è§£. å› ä¸ºå’Œå…¶ä»–è¯­è¨€éƒ½ç›¸åŒå˜›. å°±æ˜¯å±€éƒ¨å˜é‡çš„æ¦‚å¿µ.</p>
<p>ä½†æ˜¯è¿™ä¸ª<code>require</code>æ˜¯æ€ä¹ˆä¸ªæ„æ€? æˆ‘å½“æ—¶å°±æ˜¯ä»¥ä¸º<code>require</code>å°±æ˜¯æ¨ªå‘æ‹†åˆ†</p>
<p>æ¯”å¦‚æˆ‘å°±ä¸€ä¸ª<code>Main.lua</code></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> A = <span class="string">"A"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"A is: "</span>..A)</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœè‚¯å®šå°±æ˜¯</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">A</span> is: <span class="keyword">A</span></span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶æˆ‘æŠŠ<code>local A = &quot;A&quot;</code>æ”¾åˆ°å¦å¤–ä¸€ä¸ªæ–‡ä»¶<code>ClassA.lua</code>ä¸­ ç„¶åæ‰§è¡Œ</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">require</span><span class="params">(<span class="string">"ClassA"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"A is: "</span>..A)</span></span></span><br></pre></td></tr></table></figure>
<p>è¿è¡Œä¼šæŠ¥é”™</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lua: main.lua:<span class="number">4</span>: attempt to concatenate a <span class="literal">nil</span> value (global <span class="string">'A'</span>)</span><br></pre></td></tr></table></figure>
<p>æˆ‘å¤§æ¦‚çœ‹äº†ä¸€ä¸‹<code>require</code>çš„ä¼ªå®ç°ä»£ç ,åº”è¯¥æ˜¯å†…éƒ¨é€šè¿‡ä¸€ä¸ªLoaderè¿›è¡ŒåŠ è½½,ç„¶åç¼“å­˜åˆ°<code>package.loaded</code>ä¸­æ¥.æ‰€ä»¥æ˜¯å¦å¯ä»¥ç†è§£ä¸º</p>
<blockquote>
<p>æ•´ä¸ª<code>require</code>åˆ°çš„â€æ–‡ä»¶â€éƒ½æ˜¯åœ¨è¿™ä¸ªLoadå‡½æ•°çš„ä½œç”¨åŸŸä¸­(closureé—­åŒ…)?</p>
</blockquote>
<p>ä¸è¿‡ æ— è®ºå…·ä½“å®ç°å¦‚ä½• æˆ‘ç›®å‰å°±æŠŠ<code>require</code>å½“åšæ”¾åœ¨äº†ä¸€ä¸ª<code>do end</code>çš„ä»£ç å—ä¸­æ¥ç†è§£äº†</p>
<p>ä¼ªç å¦‚ä¸‹:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--require("ClassA")è½¬æ„ä¸º:</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="keyword">local</span> A = <span class="string">"A"</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--Main.lua</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"A is: "</span>..A)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="çœ‹æ‡µåœˆçš„è¯­æ³•"><a href="#çœ‹æ‡µåœˆçš„è¯­æ³•" class="headerlink" title="çœ‹æ‡µåœˆçš„è¯­æ³•"></a>çœ‹æ‡µåœˆçš„è¯­æ³•</h2><p>Luaå†…æœ‰ä¸€äº›è¯­æ³•ç³–(Syntactic sugar),è¿˜æœ‰ä¸€äº›å†…ç½®çš„å…³é”®key. æ‰€ä»¥åˆæ¥è§¦æ—¶å€™æ¯”è¾ƒæ™•, è™½ç„¶éƒ½æœ‰æ‰€äº†è§£ ä½†æ˜¯å¼€å§‹æ—¶ç†è§£çš„è¿˜æ˜¯ä¸å¤Ÿæ·±å…¥. å°±åƒä¸Šå­¦æ—¶å€™å­¦ä¹ æ–°å…¬å¼ä¼¼çš„. è®²å®Œéƒ½ä¼š ä¸€æ”¾åˆ°å…·ä½“ä¹ é¢˜é‡Œé¢åˆéƒ½æ‡µåœˆäº†.</p>
<h3 id="function"><a href="#function" class="headerlink" title="function"></a>function</h3><h4 id="function-ä¸­çš„-name"><a href="#function-ä¸­çš„-name" class="headerlink" title="function ä¸­çš„ name"></a>function ä¸­çš„ name</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Fun1=<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"Fun1 called"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fun2</span><span class="params">()</span></span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"Fun2 called"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">Fun1();</span><br><span class="line">Fun2();</span><br><span class="line"></span><br><span class="line">Wrap=&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Wrap.WFun1</span><span class="params">()</span></span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"Wrap Fun1 called"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">Wrap.WFun2=<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"Wrap Fun2 called"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">Wrap[<span class="string">"WFun1"</span>]()</span><br><span class="line">Wrap.WFun2();</span><br></pre></td></tr></table></figure>
<p>Luaä¸­å‡½æ•°å‡ä¸º<strong>åŒ¿åå‡½æ•°</strong>,æ‰€ä»¥Fun2å°±å¯ä»¥ç†è§£ä¸ºåœ¨å…¨å±€å£°æ˜äº†ä¸€ä¸ªå«Fun2çš„å˜é‡,å…¶å¼•ç”¨äº†ä¸€ä¸ªåŒ¿åå‡½æ•°,</p>
<p>åŒç†çš„,<code>Wrap.WFun1</code> å°±æ˜¯åœ¨Wrapè¿™ä¸ª<code>table</code>ä¸­ç”¨ä¸€ä¸ªWFun1ä½œä¸ºä¸€ä¸ªKey å¼•ç”¨äº†ä¸€ä¸ªåŒ¿åå‡½æ•°.</p>
<h4 id="function-ä¸­çš„"><a href="#function-ä¸­çš„" class="headerlink" title="function ä¸­çš„ :"></a>function ä¸­çš„ :</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Wrap=&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Wrap:WFun3</span><span class="params">()</span></span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"Self is a "</span>,self);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">Wrap.WFun4=<span class="function"><span class="keyword">function</span><span class="params">(_firstArg)</span></span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"First also is a "</span>,_firstArg);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Wrap.WFun3(Wrap)</span><br><span class="line">Wrap:WFun3()</span><br><span class="line"></span><br><span class="line">Wrap.WFun4(Wrap)</span><br><span class="line">Wrap:WFun4(Wrap)</span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> AnotherWrap = &#123;&#125;</span><br><span class="line">AnotherWrap.HoldKey=Wrap;</span><br><span class="line"></span><br><span class="line">Wrap.WFun3(AnotherWrap)</span><br><span class="line">AnotherWrap.HoldKey:WFun3()</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢å‡½æ•°è°ƒç”¨çš„è¾“å‡ºç»“æœä¸º:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Self is a 	<span class="built_in">table</span>: <span class="number">0x7f8353c068f0</span></span><br><span class="line">Self is a 	<span class="built_in">table</span>: <span class="number">0x7f8353c068f0</span></span><br><span class="line">First also is a <span class="built_in">table</span>: <span class="number">0x7f8353c068f0</span></span><br><span class="line">First also is a <span class="built_in">table</span>: <span class="number">0x7f8353c068f0</span></span><br><span class="line"></span><br><span class="line">Self is a 	<span class="built_in">table</span>: <span class="number">0x7f8353c02690</span></span><br><span class="line">Self is a 	<span class="built_in">table</span>: <span class="number">0x7f8353c068f0</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>:</code> åœ¨å‡½æ•°å®šä¹‰é˜¶æ®µåˆ™è¡¨ç¤ºå‡½æ•°ä¼šæœ‰ä¸€ä¸ªå‚æ•°,ç„¶åå…¶å‚æ•°åç§°ä¸º<strong><code>self</code></strong>.</p>
</li>
<li><p><code>:</code> åœ¨å‡½æ•°è°ƒç”¨é˜¶æ®µåˆ™è¡¨ç¤ºå°†è°ƒç”¨çš„Tableä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥è¯¥å‡½æ•°</p>
</li>
</ul>
<p><strong><code>self</code></strong> å’Œ <strong><code>:</code></strong> çš„æ„ä¹‰ä¹Ÿ<strong>ä»…æ­¤è€Œå·²</strong>,æ‰€ä»¥ç”¨æ—¶å€™ä¸è¦æƒ³å½“ç„¶ å°¤å…¶åœ¨åº•å±‚å·²ç»å°è£…ä¸º<code>ä¼ªç±»</code>ç»“æ„å. æˆ‘æ‡µåœˆæ—¶å€™<code>Google</code>åˆ°çš„å¥½äº›äººæçš„é—®é¢˜ éƒ½æ˜¯å› ä¸ºç›´æ¥ä½¿å¾—ç°æˆæ¶æ„ ç„¶åå¦–é­”åŒ–äº† è¿™ä¸¤ä¸ªå…³é”®å­—â˜¹ï¸</p>
<h4 id="function-ä¸­çš„-â€¦"><a href="#function-ä¸­çš„-â€¦" class="headerlink" title="function ä¸­çš„ â€¦"></a>function ä¸­çš„ â€¦</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fun1</span><span class="params">( ... )</span></span></span><br><span class="line">	<span class="keyword">local</span> a,b,c = ...</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">"Arg a=%s b=%s c=%s"</span>,a,b,c))</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">Wrap=&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Wrap.WFun1</span><span class="params">( ... )</span></span></span><br><span class="line">	<span class="keyword">local</span> <span class="built_in">arg</span> = <span class="built_in">table</span>.pack(...)</span><br><span class="line">	<span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">pairs</span>(<span class="built_in">arg</span>) <span class="keyword">do</span></span><br><span class="line">		<span class="built_in">print</span>(k,v)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">Fun1(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>,<span class="string">"D"</span>)</span><br><span class="line">Wrap.WFun1(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>,<span class="string">"D"</span>)</span><br><span class="line">Wrap:WFun1(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>,<span class="string">"D"</span>)</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœä¸º:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Arg a=A b=B c=C</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>	A</span><br><span class="line"><span class="number">2</span>	B</span><br><span class="line"><span class="number">3</span>	C</span><br><span class="line"><span class="number">4</span>	D</span><br><span class="line">n	<span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>	<span class="built_in">table</span>: <span class="number">0x7fab78406320</span></span><br><span class="line"><span class="number">2</span>	A</span><br><span class="line"><span class="number">3</span>	B</span><br><span class="line"><span class="number">4</span>	C</span><br><span class="line"><span class="number">5</span>	D</span><br><span class="line">n	<span class="number">5</span></span><br></pre></td></tr></table></figure>
<p><code>...</code>å°±æ˜¯å¯å˜å‚æ•°,å¿…é¡»ç”¨åˆ°å‡½æ•°å°¾éƒ¨çš„å£°æ˜ è¿™ä¸ªå†™åŒ¿åå‡½æ•°æ—¶å€™ä¸€èˆ¬éƒ½ä¼šæ¥è§¦åˆ°,åªä¸è¿‡æˆ‘æ¥è§¦çš„è¯­è¨€æœ‰äº›ä¼šè®©ä½ å£°æ˜æ—¶å€™æŒ‡å®šä¸ªåå­— æ¯”å¦‚<code>...yourArgName</code>,ç„¶åç›´æ¥å‡½æ•°å†…ä½¿ç”¨è¯¥åå­—å°±è¡Œäº†,Luaæ˜¯ç›´æ¥ç”¨<code>...</code> å°±ä½œä¸ºåå­—äº†.</p>
<p>å¯ä»¥ç›´æ¥<code>local a,b,c = ...</code> è¿™æ ·æŠŠæ‰€æœ‰å‚æ•°å–åˆ°, ä¹Ÿå¯ä»¥ç”¨<code>table.pack</code>ç»„è£…æˆä¸€ä¸ª<code>table</code>(Lua5.2+),æˆ–è€…ç›´æ¥<code>{...}</code>è£…è¿›ä¸€ä¸ªåŒ¿åçš„<code>table</code>ä¸­. </p>
<p><code>æ•™ç§‘ä¹¦ç¬¬å››ç‰ˆ p62 é¡µ</code> è¯´çš„å¾ˆæ¸…æ¥šäº†,å°±ä¸é‡å¤äº†</p>
<h4 id="function-ä¸­çš„-1"><a href="#function-ä¸­çš„-1" class="headerlink" title="function ä¸­çš„ {}"></a>function ä¸­çš„ {}</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fun1</span><span class="params">(_arg)</span></span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(_arg) <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">print</span>(k, v)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">Fun1(&#123;x = <span class="number">10</span>, y = <span class="number">15</span>, w = <span class="number">1280</span>, h = <span class="number">720</span>, title = <span class="string">"Hello"</span>&#125;)</span><br><span class="line"></span><br><span class="line">Fun1&#123;</span><br><span class="line">    title = <span class="string">"Hello2"</span>,</span><br><span class="line">    x = <span class="number">10</span>,</span><br><span class="line">    y = <span class="number">15</span>,</span><br><span class="line">    w = <span class="number">1280</span>,</span><br><span class="line">    h = <span class="number">720</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“å‡½æ•°åªæ¥æ”¶ä¸€ä¸ªå‚æ•°,ä¸”è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªtableæ—¶å€™ <code>Fun1({})</code>å¯ä»¥ç®€å†™æˆ Fun1{} </p>
<h3 id="metatable"><a href="#metatable" class="headerlink" title="metatable"></a>metatable</h3><p>metatable aka å…ƒè¡¨ ç®—æ˜¯Luaçš„çµé­‚äº†å§?ğŸ˜“ ,è¿™å—å…¶å®åªèƒ½å¤šçœ‹ çœ‹å„ç§äººå†™çš„ ä»å¤šè§’åº¦å»ç†è§£ æˆ‘è§‰å¾—æ˜¯æœ€å¿«ä¸Šæ‰‹æ¸ é“.</p>
<p>é‡å¤åˆ¶è½®å­æ— æ„ä¹‰,æˆ‘å°±è¯´ä¸‹æˆ‘ä¸ªäººå¯¹å…¶çš„ç†è§£å§</p>
<p>é¦–å…ˆæŠ›å¼ƒæ‰€æœ‰OOPæ€æƒ³,ä¸è¦æƒ³é‚£å † å°±å½“è‡ªå·±åˆšå­¦ç¼–ç¨‹. é¢å‘å¯¹è±¡æ˜¯ä»€ä¹ˆ? å®Œå…¨ä¸çŸ¥é“å‘¢.</p>
<p>å°†æ‰€æœ‰çš„tableéƒ½ç†è§£ä¸ºä¸€å¼ A4ç™½çº¸,æ©,å°±æ˜¯å¤å°ç”¨çš„é‚£ä¸ª! æ™®é€štableæ˜¯ä¸€å¼ ,metatableæ˜¯å¦å¤–ä¸€å¼ </p>
<p>åŒºåˆ†å¥½ <code>metatable</code>,<code>setmetatable</code>:</p>
<ul>
<li><code>metatable</code> : å°±æ˜¯ä¸€ä¸ªtableè¡¨, ä¹Ÿå°±æ˜¯ä¸€å¼ æ™®é€šçš„ A4ç™½çº¸</li>
</ul>
<ul>
<li><code>setmetatable</code> : è¿™æ˜¯ä¸€ä¸ªå‡½æ•°</li>
</ul>
<blockquote>
<p><code>setmetatable(ç™½çº¸1å·,ç™½çº¸1å·_Mt)</code> è¿™ä¸ªå°±ç¿»è¯‘ä¸º <code>ç™½çº¸1å·</code> ä½ å¤§å“¥æ˜¯ <code>ç™½çº¸1å·_Mt</code> é‚£å¼ æ™®é€šç™½çº¸. å½“ä½ æœ‰ä»€ä¹ˆä¸æ‡‚çš„æ—¶å€™ éƒ½é—®ä»–!</p>
<p>æ¯”å¦‚:</p>
<p>ä½ è¯´ ç™½çº¸1å·(PaperOne) ä½ å’Œ ç™½çº¸2å·(PaperTwo) åŠ åŠ çœ‹ æˆ‘çœ‹çœ‹èƒ½å¼„å‡ºä¸ªå•¥å‡ºæ¥! ç¿»è¯‘ä¸ºæœºå™¨ç å°±æ˜¯</p>
</blockquote>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PaperOne=&#123;&#125;</span><br><span class="line">PaperOne_Mt=&#123;&#125;</span><br><span class="line"><span class="built_in">setmetatable</span>(PaperOne,PaperOne_Mt)</span><br><span class="line"></span><br><span class="line">PaperTwo=&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> result = PaperOne+PaperTwo</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶å€™ <code>ç™½çº¸1å·</code>å°±ä¸çŸ¥é“è¿™ä¸ªtable+tableæ˜¯åº”è¯¥æ€ä¹ˆæ•´äº†,å°±é—®<code>ç™½çº¸1å·_Mt</code>,å¤§å“¥è¿™ä¸ª<code>table</code>+<code>table</code>æ€ä¹ˆæ? </p>
<p>è¿™ä¹Ÿå°±æ˜¯å…ƒè¡¨çš„ <code>ç®—æ•°è¿ç®—</code>åŠ<code>å…³ç³»è¿ç®—</code>çš„ä½œç”¨. ç›¸å…³è¯¦ç»†å®ç°è¯·çœ‹ æ•™ç§‘ä¹¦ğŸ˜‘</p>
<h4 id="index-å’Œ-newindex"><a href="#index-å’Œ-newindex" class="headerlink" title="index å’Œ newindex"></a><strong>index å’Œ </strong>newindex</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">RedPaperOne = &#123;&#125;</span><br><span class="line">RedPaperTwo = &#123;&#125;</span><br><span class="line">RedPaperTwo.Name = <span class="string">"PaperTow"</span></span><br><span class="line"></span><br><span class="line">RedPaper_Mt = &#123;&#125;</span><br><span class="line"><span class="built_in">setmetatable</span>(RedPaperOne, RedPaper_Mt)</span><br><span class="line"><span class="built_in">setmetatable</span>(RedPaperTwo, RedPaper_Mt)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">RedPaper_Mt.__index</span><span class="params">(_table, _key)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"çº¢çº¸å¤§å“¥è¯´ : ä½ "</span>, _table, <span class="string">"æ²¡æœ‰è¿™ä¸ªKey"</span>, _key, <span class="string">"ç»™ä½ ä¸ªé»˜è®¤å€¼ 66666 å¥½äº†"</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"66666"</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"RedPaperOne æˆ‘çš„åå­—æ˜¯: "</span>, RedPaperOne.Name)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"RedPaperTwo æˆ‘çš„åå­—æ˜¯: "</span>, RedPaperTwo.Name)</span><br><span class="line"></span><br><span class="line">GreenPaperOne = &#123;&#125;</span><br><span class="line">GreenPaperTwo = &#123;&#125;</span><br><span class="line">GreenPaperTwo.Name = <span class="string">"ç»¿2å·"</span></span><br><span class="line"></span><br><span class="line">GreenPaper_Mt = &#123;&#125;</span><br><span class="line">GreenPaper_Mt.Name = <span class="string">"å°ç»¿"</span></span><br><span class="line">GreenPaper_Mt.<span class="built_in">__index</span> = GreenPaper_Mt</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(GreenPaperOne, GreenPaper_Mt)</span><br><span class="line"><span class="built_in">setmetatable</span>(GreenPaperTwo, GreenPaper_Mt)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"GreenPaperOne æˆ‘çš„åå­—æ˜¯: "</span>, GreenPaperOne.Name)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"GreenPaperTwo æˆ‘çš„åå­—æ˜¯: "</span>, GreenPaperTwo.Name)</span><br><span class="line"></span><br><span class="line">BluePaperOne = &#123;&#125;</span><br><span class="line">BluePaper_Mt = &#123;&#125;</span><br><span class="line">BluePaper_Mt.<span class="built_in">__newindex</span> = <span class="function"><span class="keyword">function</span> <span class="params">(_table, _key, _value)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"è“çº¸å¤§å“¥è¯´: ä½ å°±æ˜¯å°è“ åˆ«é—¹"</span>)</span><br><span class="line">    <span class="built_in">rawset</span>(_table, _key, <span class="string">"å°è“"</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(BluePaperOne, BluePaper_Mt)</span><br><span class="line"></span><br><span class="line">BluePaperOne.Name = <span class="string">"æˆ‘æ˜¯å°ç»¿"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"BluePaperOne æˆ‘çš„åå­—æ˜¯: "</span>, BluePaperOne.Name)</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœ:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">çº¢çº¸å¤§å“¥è¯´ : ä½ 	<span class="built_in">table</span>: <span class="number">0x7fa05a406930</span> æ²¡æœ‰è¿™ä¸ªKey Name ç»™ä½ ä¸ªé»˜è®¤å€¼ <span class="number">66666</span> å¥½äº†</span><br><span class="line"></span><br><span class="line">RedPaperOne æˆ‘çš„åå­—æ˜¯: <span class="number">66666</span></span><br><span class="line">RedPaperTwo æˆ‘çš„åå­—æ˜¯: PaperTow</span><br><span class="line"></span><br><span class="line">GreenPaperOne æˆ‘çš„åå­—æ˜¯: å°ç»¿</span><br><span class="line">GreenPaperTwo æˆ‘çš„åå­—æ˜¯: ç»¿<span class="number">2</span>å·</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è“çº¸å¤§å“¥è¯´: ä½ å°±æ˜¯å°è“ åˆ«é—¹</span><br><span class="line">BluePaperOne æˆ‘çš„åå­—æ˜¯: å°è“</span><br></pre></td></tr></table></figure>
<p><code>__index</code>å’Œ <code>__newindex</code> éƒ½æ˜¯ <code>å¤§å“¥</code>èº«ä¸Šä¸¤ä¸ªç‰¹æœ‰çš„å±æ€§,ä¸€ä¸ªè´Ÿè´£<code>å°å¼Ÿ</code>èº«ä¸Šæ²¡æœ‰è¿™ä¸ªå±æ€§æ—¶å€™å»get,å¦ä¸€ä¸ªè´Ÿè´£å»set</p>
<p>å½“<code>å°å¼Ÿ</code>èº«ä¸Šæœ‰è¿™ä¸ªå±æ€§äº†,å°å¼Ÿæ˜¯æ ¹æœ¬éƒ½ä¸ä¼šé¸Ÿå¤§å“¥çš„,è‡ªå·±å°±å¤„ç†æ‰äº†.</p>
<p>æœ‰äº›æ—¶å€™<code>å¤§å“¥</code>ä¼šæŠŠè¿™ä¸¤ä¸ª<code>key</code>å®šä¹‰ä¸ºä¸¤ä¸ªå‡½æ•°,å¤§å“¥è‡ªå·±çœŸåšç‚¹äº‹å„¿. ä½†æœ‰çš„æ—¶å€™å¤§å“¥å°±æ‡’,ç›´æ¥å°± <code>å¤§å“¥.__index=å¤§å“¥</code></p>
<p>æ­¤æ—¶å°å¼Ÿå½“å¤„ç†ä¸äº†æ—¶å€™é—®å¤§å“¥:  å¤§å“¥,é‚£å“¥ä»¬å„¿è¦è¾“å‡ºæˆ‘èº«ä¸Šçš„<code>Name</code>å±æ€§,æˆ‘æ²¡é‚£ç©æ„å„¿å•Š,å¤§å“¥é—­ç€çœ¼ç‘ æŒ‡äº†æŒ‡è‡ªå·±èº«ä¸Šçš„<code>Name=å°ç»¿</code>é‚£æ¡è®°å½•. å°å¼Ÿå°±å¿ƒé¢†ç¥ä¼šçš„æŠŠâ€å°ç»¿â€ è¿”å›äº†.</p>
<p>ä»¥ä¸Šè®¾ç½®äº†ä¸€ä¸ªå¾ˆ2Bçš„æƒ…æ™¯,ä½†æ˜¯æœ‰äº›æ—¶å€™ ç¢°åˆ°ä¸€äº›ä¸æ˜¯å¾ˆå®¹æ˜“çœ‹æ‡‚çš„ä»£ç  ä½ å¯ä»¥æ˜¯è¿™æŠŠé‚£æ®µä»£ç å¸¦å…¥ æƒ…æ™¯,æ²¡å‡†ä¼šæ›´å®¹æ˜“å¸®ä½ ç†è§£.</p>
<p>æœ‰ä¸ªè¡¥å……å°±æ˜¯<code>__newindex</code>å†…éƒ¨å®ç°ä½¿ç”¨äº†<code>rawset</code>,å°±æ˜¯è®©å°å¼Ÿå¿½ç•¥<code>__newindex</code>å®ç°,è¿›è¡Œç›´æ¥èµ‹å€¼,å¦‚æœä¸è¿™ä¹ˆå†™å°±å˜æˆè‡ªå·±è°ƒè‡ªå·±,ç„¶åæ— é™å¾ªç¯ä¸‹å»äº†.</p>
<h4 id="ç•™æ„-setmetatable-x-index-y"><a href="#ç•™æ„-setmetatable-x-index-y" class="headerlink" title="ç•™æ„ setmetatable(x,{__index=y})"></a>ç•™æ„ setmetatable(x,{__index=y})</h4><p><code>setmetatable(x,{__index=y})</code> è¿™è¡Œä»£ç å…¶å®æœ‰ä¸ªå‘,åˆšå¼€å§‹è¢«ç»•è¿›å»äº†. å°±æ˜¯è¿™é‡Œé¢å…¶å®æ˜¯æœ‰3å¼ è¡¨çš„,å°±æ˜¯ä¸‰ä¸ªç™½çº¸. è¿˜æ˜¯å¥—ç”¨ä¸Šé¢çš„ä¾‹å­ ä¸€ä¸ªæ˜¯<code>ç™½çº¸1å·</code>,å¦ä¸€ä¸ªæ˜¯<code>ç™½çº¸ä¸€å·_Mt</code>. ä½†æ˜¯é‡Œé¢è¿˜æœ‰ä¸€ä¸ªåŒ¿å<code>table</code>å°±æ˜¯{__index=y}</p>
<p>ç¿»è¯‘ä¸º2Bæƒ…æ™¯å°±æ˜¯</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">PaperOne=&#123;&#125;</span><br><span class="line">PaperOne_Fake_Brother=&#123;&#125;</span><br><span class="line">PaperOne_Fake_Brother.Name=<span class="string">"æˆ‘æ˜¯ä½ å‡å¤§å“¥"</span></span><br><span class="line"></span><br><span class="line">PaperReal_Brother=&#123;&#125;</span><br><span class="line">PaperReal_Brother.Name=<span class="string">"æˆ‘æ˜¯ä½ çœŸå¤§å“¥"</span></span><br><span class="line">PaperReal_Brother.<span class="built_in">__index</span>=PaperOne_Fake_Brother</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(PaperOne,PaperReal_Brother)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(PaperOne.Name)</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœ:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘æ˜¯ä½ å‡å¤§å“¥</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>åšæŒåŸåˆ›æŠ€æœ¯åˆ†äº«ï¼Œæ‚¨çš„æ”¯æŒå°†é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œï¼</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>æ‰“èµ</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="éš”å£è€ç‹ å¾®ä¿¡æ”¯ä»˜"/>
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="éš”å£è€ç‹ æ”¯ä»˜å®"/>
        <p>æ”¯ä»˜å®</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Lua/" rel="tag"># Lua</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/fb1d9ef0-ae96-11e8-bce8-210b733613c3/" rel="next" title="Luaä»å…¥é—¨åˆ°å…¥äº†é—¨(1) æ­å»ºå­¦ä¹ ç¯å¢ƒ">
                <i class="fa fa-chevron-left"></i> Luaä»å…¥é—¨åˆ°å…¥äº†é—¨(1) æ­å»ºå­¦ä¹ ç¯å¢ƒ
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/001ee6c0-ae97-11e8-ac40-db55252f3df1/" rel="prev" title="Luaä»å…¥é—¨åˆ°å…¥äº†é—¨(3) OOPæ·±å…¥åˆ†æä¹‹æ•™ç§‘ä¹¦ç‰ˆ">
                Luaä»å…¥é—¨åˆ°å…¥äº†é—¨(3) OOPæ·±å…¥åˆ†æä¹‹æ•™ç§‘ä¹¦ç‰ˆ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  
    <div class="comments" id="comments">
      <div id="vcomments"></div>
    </div>
  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">éš”å£è€ç‹</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">38</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">31</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#å¦‚ä½•ç»„ç»‡ä»£ç "><span class="nav-number">1.</span> <span class="nav-text">å¦‚ä½•ç»„ç»‡ä»£ç </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å®é™…é¡¹ç›®"><span class="nav-number">1.1.</span> <span class="nav-text">å®é™…é¡¹ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#require-ä¸­-localçš„ä½œç”¨åŸŸ"><span class="nav-number">1.2.</span> <span class="nav-text">require ä¸­ localçš„ä½œç”¨åŸŸ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#çœ‹æ‡µåœˆçš„è¯­æ³•"><span class="nav-number">2.</span> <span class="nav-text">çœ‹æ‡µåœˆçš„è¯­æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#function"><span class="nav-number">2.1.</span> <span class="nav-text">function</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#function-ä¸­çš„-name"><span class="nav-number">2.1.1.</span> <span class="nav-text">function ä¸­çš„ name</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#function-ä¸­çš„"><span class="nav-number">2.1.2.</span> <span class="nav-text">function ä¸­çš„ :</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#function-ä¸­çš„-â€¦"><span class="nav-number">2.1.3.</span> <span class="nav-text">function ä¸­çš„ â€¦</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#function-ä¸­çš„-1"><span class="nav-number">2.1.4.</span> <span class="nav-text">function ä¸­çš„ {}</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#metatable"><span class="nav-number">2.2.</span> <span class="nav-text">metatable</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#index-å’Œ-newindex"><span class="nav-number">2.2.1.</span> <span class="nav-text">index å’Œ newindex</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ç•™æ„-setmetatable-x-index-y"><span class="nav-number">2.2.2.</span> <span class="nav-text">ç•™æ„ setmetatable(x,{__index=y})</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">éš”å£è€ç‹</span>

  
</div>









        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>è®¿é—®äººæ•°
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>æ€»è®¿é—®é‡
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      æ¬¡
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  






  
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine@1.1.4/dist/Valine.min.js"></script>
  <script type="text/javascript">
    new Valine({
        av: AV,
        el: '#vcomments' ,
        verify: false,
        notify: false,
        app_id: 'VgjGdP2hIi00FTVlhhkQYpOx-gzGzoHsz',
        app_key: 'f6jqD57DmTmu5lR3DdobF3py',
        placeholder: 'è¯´ç‚¹å•¥?'
    });
  </script>



  





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

  

</body>
</html>
